import{_ as F,T as V,R as f,j as e,q as R,F as r,J as b,m as S,n as i,t as y,p as T,S as m,I as _,aT as v,C as E,aU as L,d as p,B as O}from"./index-7ade8dfe.js";import{M as P}from"./MinusCircleOutlined-f6a845b7.js";const Y=()=>{const s=F(),{formProps:t,saveButtonProps:g}=V(),{selectProps:q}=f({resource:"customers",optionLabel:"name",optionValue:"id"}),{selectProps:C,queryResult:x}=f({resource:"products",optionLabel:"name",optionValue:"id"}),I=(a,j)=>{var c,o,d,l;const{items:u}=(c=t==null?void 0:t.form)==null?void 0:c.getFieldsValue(["items"]);u[j].product_id=a,u[j].product=(d=(o=x==null?void 0:x.data)==null?void 0:o.data)==null?void 0:d.find(n=>n.id===a),(l=t==null?void 0:t.form)==null||l.setFieldsValue({items:u})};return e.jsx(R,{saveButtonProps:g,children:e.jsx(r,{...t,layout:"vertical",children:e.jsxs(b,{defaultActiveKey:"1",children:[e.jsx(b.TabPane,{tab:s("joborders.tabs.basic"),forceRender:!0,children:e.jsxs(S,{gutter:24,children:[e.jsx(i,{span:12,children:e.jsx(r.Item,{label:s("joborders.fields.issued_date"),name:["issued_date"],rules:[{required:!0}],getValueProps:a=>({value:a?y(a):null}),getValueFromEvent:a=>a?y(a):null,children:e.jsx(T,{format:"YYYY-MM-DD",style:{width:"100%"}})})}),e.jsx(i,{span:12,children:e.jsx(r.Item,{label:s("joborders.fields.customer"),name:["customer","id"],rules:[{required:!0,message:s("rules.requiredOption")}],children:e.jsx(m,{placeholder:s("joborders.fields.customer"),...q})})}),e.jsx(i,{span:12,children:e.jsx(r.Item,{label:s("joborders.fields.order_no"),name:["order_no"],rules:[{required:!0}],children:e.jsx(_,{})})}),e.jsx(i,{span:12,children:e.jsx(r.Item,{label:s("joborders.fields.po_category"),name:["po_category"],rules:[{required:!0}],children:e.jsx(m,{allowClear:!0,options:v,placeholder:s("joborders.fields.po_category")})})}),e.jsx(i,{span:12,children:e.jsx(r.Item,{label:s("joborders.fields.status"),name:["status"],rules:[{required:!0}],children:e.jsx(m,{allowClear:!0,options:E,placeholder:s("joborders.fields.status")})})}),e.jsx(i,{span:12,children:e.jsx(r.Item,{label:s("joborders.fields.process_status"),name:["process_status"],rules:[{required:!0}],children:e.jsx(m,{allowClear:!0,options:L,placeholder:s("joborders.fields.process_status")})})})]})},"1"),e.jsx(b.TabPane,{tab:s("joborders.tabs.items"),forceRender:!0,children:e.jsx(r.List,{name:["items"],children:(a,{add:j,remove:u})=>e.jsxs(e.Fragment,{children:[e.jsxs(p,{dataSource:a,pagination:!1,rowKey:"key",children:[e.jsx(p.Column,{title:s("joborders.items.fields.product"),dataIndex:"product_id",render:(c,o,d)=>e.jsx(r.Item,{name:[o.name,"product_id"],rules:[{required:!0,message:s("rules.requiredOption")}],children:e.jsx(m,{placeholder:s("joborders.items.placeholders.product"),...C,onChange:l=>I(l,o.name)})})},"product_id"),e.jsx(p.Column,{title:s("joborders.items.fields.quantity"),dataIndex:"quantity",render:(c,o,d)=>{var h;const l=(h=t==null?void 0:t.form)==null?void 0:h.getFieldValue(["items",o.name,"product"]);let n=l==null?void 0:l.unit_type;return n&&n!=="PIECE"&&(n=l.unit_weight_type),e.jsx(r.Item,{name:[o.name,"quantity"],rules:[{required:!0}],getValueFromEvent:w=>Number(w.target.value),children:e.jsx(_,{type:"number",placeholder:s("joborders.items.placeholders.quantity"),addonAfter:n})})}},"quantity"),e.jsx(p.Column,{title:s("table.actions"),dataIndex:"action",render:(c,o,d)=>e.jsx(r.Item,{children:e.jsx(P,{onClick:()=>u(d)})})})]}),e.jsx(O,{type:"dashed",onClick:()=>j(),style:{width:"100%"},children:s("joborders.items.buttons.add")})]})})},"2")]})})})};export{Y as JobOrderEdit,Y as default};
