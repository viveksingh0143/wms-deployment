import{_ as y,a as R,b as F,c as A,P as N,d as o,j as e,e as P,G as k,f as g,D as z,t as B,aw as Y,H as K,h as M,Y as G,r as H,R as J,i as f,F as n,I as C,B as S,k as I,l as _,m as V,n as h,o as U,S as b,C as W,p as Q}from"./index-7ade8dfe.js";const{RangePicker:X}=Q,te=()=>{const r=y(),{tableProps:s,searchFormProps:l}=R({syncWithLocation:!0,onSearch:t=>{const a=[],{q:u,po_category:x,order_no:p,issued_date:v,customer_id:w,status:D,createdAt:j}=t;return a.push({field:"query",operator:"eq",value:u},{field:"po_category",operator:"eq",value:x},{field:"order_no",operator:"eq",value:p},{field:"issued_date",operator:"eq",value:v},{field:"status",operator:"eq",value:D},{field:"customer_id",operator:"eq",value:w},{field:"createdAt",operator:"gte",value:j?j[0].toISOString():void 0},{field:"createdAt",operator:"lte",value:j?j[1].toISOString():void 0}),a}}),{triggerExport:i,isLoading:m}=F({mapData:t=>{var a;return{id:t.id,issued_date:t.issued_date,po_category:t.po_category,order_no:t.order_no,status:t.status,customer:((a=t==null?void 0:t.customer)==null?void 0:a.name)||""}}}),[d,c]=A.useState([]),{mutate:E,isLoading:T}=N(),L=()=>{E({resource:"joborders",ids:d.map(String)},{onSuccess:()=>{c([])}})},q={selectedRowKeys:d,onChange:t=>{c(t)},selections:[o.SELECTION_ALL,o.SELECTION_INVERT,o.SELECTION_NONE]},O=t=>{switch(t){case"NOT STARTED":return"default";case"STARTED":return"processing";case"CLOSED":return"success";case"REJECTED":return"error";default:return"error"}};return e.jsxs(P,{headerButtons:({defaultButtons:t})=>e.jsxs(e.Fragment,{children:[t,e.jsx(k,{onClick:i,loading:m})]}),headerProps:{subTitle:e.jsx(g,{children:e.jsx(z,{selectedKeys:d,isLoading:T,onDelete:L})})},children:[e.jsx(Z,{formProps:l}),e.jsxs(o,{...s,rowSelection:q,rowKey:"id",pagination:{...s.pagination,showSizeChanger:!0},children:[e.jsx(o.Column,{title:r("table.s_no"),render:(t,a,u)=>{let x=1,p=10;return typeof s.pagination=="object"&&(x=s.pagination.current??1,p=s.pagination.pageSize??10),(x-1)*p+u+1}},"index"),e.jsx(o.Column,{dataIndex:"issued_date",title:r("joborders.fields.issued_date"),sorter:!0,render:(t,a,u)=>B(t).format("YYYY-MM-DD")}),e.jsx(o.Column,{dataIndex:"po_category",title:r("joborders.fields.po_category"),sorter:!0}),e.jsx(o.Column,{dataIndex:"order_no",title:r("joborders.fields.order_no"),sorter:!0}),e.jsx(o.Column,{dataIndex:"status",title:r("joborders.fields.status"),sorter:!0}),e.jsx(o.Column,{dataIndex:"process_status",title:r("joborders.fields.process_status"),sorter:!0,render:(t,a)=>e.jsx(Y,{status:O(t),text:t})}),e.jsx(o.Column,{dataIndex:["customer","name"],title:r("joborders.fields.customer"),sorter:!0}),e.jsx(o.Column,{title:r("table.actions"),dataIndex:"actions",render:(t,a)=>e.jsxs(g,{children:[e.jsx(K,{hideText:!0,size:"small",recordItemId:a.id}),e.jsx(M,{hideText:!0,size:"small",recordItemId:a.id}),e.jsx(G,{hideText:!0,size:"small",recordItemId:a.id})]})})]})]})},Z=({formProps:r})=>{const s=y(),[l,i]=H.useState(!0),{selectProps:m}=J({resource:"customers",optionLabel:"name",optionValue:"id"}),d=()=>e.jsx(f,{title:e.jsx(n,{layout:"inline",...r,onFinish:r==null?void 0:r.onFinish,children:e.jsx(n.Item,{name:"q",style:{width:"100%"},children:e.jsx(C.Search,{placeholder:s("filter.placeholders.query"),enterButton:s("filter.buttons.search")})})}),extra:e.jsx(S,{type:"text",onClick:()=>i(!l),children:l?e.jsx(I,{}):e.jsx(_,{})}),bodyStyle:{padding:"0px"}}),c=()=>e.jsx(f,{title:s("filter.title"),extra:e.jsx(S,{onClick:()=>i(!l),type:"text",children:l?e.jsx(I,{}):e.jsx(_,{})}),children:e.jsxs(n,{layout:"vertical",...r,children:[e.jsxs(V,{gutter:24,children:[e.jsx(h,{span:6,children:e.jsx(n.Item,{label:s("filter.fields.query"),name:"q",children:e.jsx(C,{placeholder:s("filter.placeholders.query"),prefix:e.jsx(U,{})})})}),e.jsx(h,{span:6,children:e.jsx(n.Item,{label:s("joborders.fields.status"),name:"status",children:e.jsx(b,{allowClear:!0,options:W,placeholder:s("joborders.placeholders.status")})})}),e.jsx(h,{span:6,children:e.jsx(n.Item,{label:s("joborders.fields.customer"),name:"customer_id",children:e.jsx(b,{...m,allowClear:!0,onSearch:void 0,filterOption:!0,optionFilterProp:"label"})})}),e.jsx(h,{span:6,children:e.jsx(n.Item,{label:s("filter.fields.created_at"),name:"createdAt",children:e.jsx(X,{})})})]}),e.jsx(n.Item,{children:e.jsx(S,{htmlType:"submit",type:"primary",children:s("filter.buttons.search")})})]})});return l?d():c()};export{te as JobOrderList,te as default};
