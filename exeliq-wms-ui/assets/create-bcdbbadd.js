import{_ as R,r as x,T as P,a as b,j as t,V as A,F as o,I as g,S as D,C as S,bb as m,d as n}from"./index-7ade8dfe.js";const F=()=>{const a=R(),[i,_]=x.useState([]),[c,E]=x.useState([]),{formProps:f,saveButtonProps:j,form:p,onFinish:h}=P(),{tableProps:T}=b({resource:"permissions",hasPagination:!1,sorters:{permanent:[{field:"group_name",order:"desc"}]}}),C=l=>{l.abilities=l.abilities.map(e=>{if(e!==null&&e!==""&&(typeof e=="string"||e instanceof String)){const[s,d]=e.split("::");return{module:s,name:d}}}),h(l)},$={selectedRowKeys:i,onChange:(l,e)=>{const s=new Set(p.getFieldValue("abilities"));l.length<i.length?i.filter(u=>!l.includes(u)).forEach(u=>{const r=c.find(I=>I.id===u);r&&(s.delete(`${r.module_name}::READ`),s.delete(`${r.module_name}::CREATE`),s.delete(`${r.module_name}::UPDATE`),s.delete(`${r.module_name}::DELETE`),s.delete(`${r.module_name}::IMPORT`),s.delete(`${r.module_name}::EXPORT`))}):e.forEach(d=>{s.add(`${d.module_name}::READ`),s.add(`${d.module_name}::CREATE`),s.add(`${d.module_name}::UPDATE`),s.add(`${d.module_name}::DELETE`),s.add(`${d.module_name}::IMPORT`),s.add(`${d.module_name}::EXPORT`)}),p.setFieldValue("abilities",Array.from(s)),_(l),E(e)}};return t.jsx(A,{saveButtonProps:j,children:t.jsxs(o,{...f,initialValues:{status:1,abilities:[]},onFinish:C,layout:"vertical",children:[t.jsx(o.Item,{label:a("roles.fields.name"),name:["name"],rules:[{required:!0}],children:t.jsx(g,{})}),t.jsx(o.Item,{label:a("roles.fields.status"),name:["status"],rules:[{required:!0}],children:t.jsx(D,{allowClear:!0,options:S,placeholder:"Status"})}),t.jsx(o.Item,{name:["abilities"],children:t.jsx(m.Group,{style:{width:"100%"},children:t.jsxs(n,{...T,rowSelection:$,rowKey:"id",style:{width:"100%"},children:[t.jsx(n.Column,{title:a("table.s_no"),render:(l,e,s)=>s+1},"index"),t.jsx(n.Column,{dataIndex:"group_name",title:a("permissions.fields.group_name")}),t.jsx(n.Column,{dataIndex:"module_name",title:a("permissions.fields.module_name")}),t.jsx(n.Column,{dataIndex:"read_perm",title:a("permissions.fields.read_perm"),render:(l,e)=>e.read_perm?t.jsx(m,{value:`${e.module_name}::READ`}):null}),t.jsx(n.Column,{dataIndex:"create_perm",title:a("permissions.fields.create_perm"),render:(l,e)=>e.create_perm?t.jsx(m,{value:`${e.module_name}::CREATE`}):null}),t.jsx(n.Column,{dataIndex:"update_perm",title:a("permissions.fields.update_perm"),render:(l,e)=>e.update_perm?t.jsx(m,{value:`${e.module_name}::UPDATE`}):null}),t.jsx(n.Column,{dataIndex:"delete_perm",title:a("permissions.fields.delete_perm"),render:(l,e)=>e.delete_perm?t.jsx(m,{value:`${e.module_name}::DELETE`}):null}),t.jsx(n.Column,{dataIndex:"import_perm",title:a("permissions.fields.import_perm"),render:(l,e)=>e.import_perm?t.jsx(m,{value:`${e.module_name}::IMPORT`}):null}),t.jsx(n.Column,{dataIndex:"export_perm",title:a("permissions.fields.export_perm"),render:(l,e)=>e.export_perm?t.jsx(m,{value:`${e.module_name}::EXPORT`}):null})]})})})]})})};export{F as RoleCreate,F as default};
