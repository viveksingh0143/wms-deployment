import{b8 as A,_ as T,r as L,a as B,b as P,c as K,P as M,d as r,j as e,e as Y,G,f as I,D as H,B as j,w as x,aw as $,H as U,h as V,Y as W,i as _,F as o,I as C,k as y,l as E,m as J,n as S,o as Q,S as X,ba as Z,p as ee}from"./index-7ade8dfe.js";import{r as te,s as se,m as ae}from"./printerfn-12fd91a5.js";import{C as ne}from"./container-557faff1.js";const{RangePicker:le}=ee,xe=()=>{const{storeId:i}=A(),s=T(),[c,p]=L.useState(!1),{tableProps:l,searchFormProps:b}=B({meta:{parentResources:[{name:"stores",value:i}]},syncWithLocation:!0,onSearch:t=>{const a=[],{q:d,code:n,zone_name:u,aisle_number:f,rack_number:D,shelf_number:F,description:oe,status:N,createdAt:m}=t;return a.push({field:"query",operator:"eq",value:d},{field:"code",operator:"contains",value:n},{field:"zone_name",operator:"contains",value:u},{field:"aisle_number",operator:"contains",value:f},{field:"rack_number",operator:"contains",value:D},{field:"shelf_number",operator:"contains",value:F},{field:"status",operator:"eq",value:N},{field:"createdAt",operator:"gte",value:m?m[0].toISOString():void 0},{field:"createdAt",operator:"lte",value:m?m[1].toISOString():void 0}),a}}),{triggerExport:v,isLoading:w}=P({mapData:t=>({id:t.id,code:t.code,zone_name:t.zone_name,aisle_number:t.aisle_number,rack_number:t.rack_number,shelf_number:t.shelf_number,status:t.status})}),[h,g]=K.useState([]),{mutate:k,isLoading:z}=M(),O=()=>{k({resource:"locations",ids:h.map(String)},{onSuccess:()=>{g([])}})},R={selectedRowKeys:h,onChange:t=>{g(t)},selections:[r.SELECTION_ALL,r.SELECTION_INVERT,r.SELECTION_NONE]},q=async()=>{if(!(l!=null&&l.dataSource))return;p(!0);let t=0,a=0;const d=l.dataSource.filter(n=>h.includes(n==null?void 0:n.id)).map(n=>te(ne,{CONTAINER_CODE:n.code}))||[];for(let n of d){const u=new Blob([n],{type:"text/plain"});try{await se(u),t++}catch(f){console.error("Error sending print job:",f),a++}}p(!1),ae.info(`Printing completed. Success: ${t}, Failed: ${a}`)};return e.jsxs(Y,{headerButtons:({defaultButtons:t})=>e.jsxs(e.Fragment,{children:[t,e.jsx(G,{onClick:v,loading:w})]}),headerProps:{subTitle:e.jsxs(I,{children:[e.jsx(H,{selectedKeys:h,isLoading:z,onDelete:O}),e.jsx(j,{disabled:h.length<1,type:"primary",onClick:q,children:s("buttons.print-barcode")})]})},children:[e.jsx(re,{formProps:b}),e.jsxs(r,{...l,rowSelection:R,rowKey:"id",pagination:{...l.pagination,showSizeChanger:!0},expandable:{expandedRowRender:t=>e.jsxs(x,{bordered:!0,children:[e.jsx(x.Item,{label:s("locations.fields.zone_name"),children:t.zone_name}),e.jsx(x.Item,{label:s("locations.fields.aisle_number"),children:t.aisle_number}),e.jsx(x.Item,{label:s("locations.fields.rack_number"),children:t.rack_number}),e.jsx(x.Item,{label:s("locations.fields.shelf_number"),children:t.shelf_number}),e.jsx(x.Item,{label:s("locations.fields.description"),children:t.description})]})},children:[e.jsx(r.Column,{title:s("table.s_no"),render:(t,a,d)=>{let n=1,u=10;return typeof l.pagination=="object"&&(n=l.pagination.current??1,u=l.pagination.pageSize??10),(n-1)*u+d+1}},"index"),e.jsx(r.Column,{dataIndex:"code",title:s("locations.fields.code"),sorter:!0}),e.jsx(r.Column,{dataIndex:"status",title:s("locations.fields.status"),sorter:!0,render:(t,a,d)=>e.jsx($,{status:(a==null?void 0:a.status)==="EMPTY"?"processing":"success",text:a==null?void 0:a.status})}),e.jsx(r.Column,{title:s("table.actions"),dataIndex:"actions",render:(t,a)=>e.jsxs(I,{children:[e.jsx(U,{hideText:!0,size:"small",recordItemId:a.id}),e.jsx(V,{hideText:!0,size:"small",recordItemId:a.id}),e.jsx(W,{hideText:!0,size:"small",recordItemId:a.id})]})})]})]})},re=({formProps:i})=>{const s=T(),[c,p]=L.useState(!0),l=()=>e.jsx(_,{title:e.jsx(o,{layout:"inline",...i,onFinish:i==null?void 0:i.onFinish,children:e.jsx(o.Item,{name:"q",style:{width:"100%"},children:e.jsx(C.Search,{placeholder:s("filter.placeholders.query"),enterButton:s("filter.buttons.search")})})}),extra:e.jsx(j,{type:"text",onClick:()=>p(!c),children:c?e.jsx(y,{}):e.jsx(E,{})}),bodyStyle:{padding:"0px"}}),b=()=>e.jsx(_,{title:s("filter.title"),extra:e.jsx(j,{onClick:()=>p(!c),type:"text",children:c?e.jsx(y,{}):e.jsx(E,{})}),children:e.jsxs(o,{layout:"vertical",...i,children:[e.jsxs(J,{gutter:24,children:[e.jsx(S,{span:6,children:e.jsx(o.Item,{label:s("filter.fields.query"),name:"q",children:e.jsx(C,{placeholder:s("filter.placeholders.query"),prefix:e.jsx(Q,{})})})}),e.jsx(S,{span:6,children:e.jsx(o.Item,{label:s("locations.fields.status"),name:"status",children:e.jsx(X,{allowClear:!0,options:Z,placeholder:s("locations.placeholders.status")})})}),e.jsx(S,{span:6,children:e.jsx(o.Item,{label:s("filter.fields.created_at"),name:"createdAt",children:e.jsx(le,{})})})]}),e.jsx(o.Item,{children:e.jsx(j,{htmlType:"submit",type:"primary",children:s("filter.buttons.search")})})]})});return c?l():b()};export{xe as LocationList,xe as default};
