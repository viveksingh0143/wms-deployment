import{_,a as R,b as F,c as D,P as k,d as i,j as e,e as z,G as N,f,D as P,t as Y,H as A,h as B,Y as K,r as M,R as G,i as C,F as n,I,B as S,k as g,l as q,m as H,n as j,o as V,S as y,C as U,p as W}from"./index-7ade8dfe.js";const{RangePicker:J}=W,$=()=>{const r=_(),{tableProps:s,searchFormProps:o}=R({syncWithLocation:!0,onSearch:t=>{const a=[],{q:c,department:x,order_no:p,issued_date:T,store_id:w,status:O,createdAt:h}=t;return a.push({field:"query",operator:"eq",value:c},{field:"department",operator:"eq",value:x},{field:"order_no",operator:"eq",value:p},{field:"issued_date",operator:"eq",value:T},{field:"status",operator:"eq",value:O},{field:"store_id",operator:"eq",value:w},{field:"createdAt",operator:"gte",value:h?h[0].toISOString():void 0},{field:"createdAt",operator:"lte",value:h?h[1].toISOString():void 0}),a}}),{triggerExport:d,isLoading:m}=F({mapData:t=>{var a;return{id:t.id,issued_date:t.issued_date,department:t.department,order_no:t.order_no,status:t.status,store:((a=t==null?void 0:t.store)==null?void 0:a.name)||""}}}),[l,u]=D.useState([]),{mutate:b,isLoading:L}=k(),v=()=>{b({resource:"requisitions",ids:l.map(String)},{onSuccess:()=>{u([])}})},E={selectedRowKeys:l,onChange:t=>{u(t)},selections:[i.SELECTION_ALL,i.SELECTION_INVERT,i.SELECTION_NONE]};return e.jsxs(z,{headerButtons:({defaultButtons:t})=>e.jsxs(e.Fragment,{children:[t,e.jsx(N,{onClick:d,loading:m})]}),headerProps:{subTitle:e.jsx(f,{children:e.jsx(P,{selectedKeys:l,isLoading:L,onDelete:v})})},children:[e.jsx(Q,{formProps:o}),e.jsxs(i,{...s,rowSelection:E,rowKey:"id",pagination:{...s.pagination,showSizeChanger:!0},children:[e.jsx(i.Column,{title:r("table.s_no"),render:(t,a,c)=>{let x=1,p=10;return typeof s.pagination=="object"&&(x=s.pagination.current??1,p=s.pagination.pageSize??10),(x-1)*p+c+1}},"index"),e.jsx(i.Column,{dataIndex:"issued_date",title:r("requisitions.fields.issued_date"),sorter:!0,render:(t,a,c)=>Y(t).format("YYYY-MM-DD")}),e.jsx(i.Column,{dataIndex:"department",title:r("requisitions.fields.department"),sorter:!0}),e.jsx(i.Column,{dataIndex:"order_no",title:r("requisitions.fields.order_no"),sorter:!0}),e.jsx(i.Column,{dataIndex:"status",title:r("requisitions.fields.status"),sorter:!0}),e.jsx(i.Column,{dataIndex:["store","name"],title:r("requisitions.fields.store"),sorter:!0}),e.jsx(i.Column,{title:r("table.actions"),dataIndex:"actions",render:(t,a)=>e.jsxs(f,{children:[e.jsx(A,{hideText:!0,size:"small",recordItemId:a.id}),e.jsx(B,{hideText:!0,size:"small",recordItemId:a.id}),e.jsx(K,{hideText:!0,size:"small",recordItemId:a.id})]})})]})]})},Q=({formProps:r})=>{const s=_(),[o,d]=M.useState(!0),{selectProps:m}=G({resource:"stores",optionLabel:"name",optionValue:"id"}),l=()=>e.jsx(C,{title:e.jsx(n,{layout:"inline",...r,onFinish:r==null?void 0:r.onFinish,children:e.jsx(n.Item,{name:"q",style:{width:"100%"},children:e.jsx(I.Search,{placeholder:s("filter.placeholders.query"),enterButton:s("filter.buttons.search")})})}),extra:e.jsx(S,{type:"text",onClick:()=>d(!o),children:o?e.jsx(g,{}):e.jsx(q,{})}),bodyStyle:{padding:"0px"}}),u=()=>e.jsx(C,{title:s("filter.title"),extra:e.jsx(S,{onClick:()=>d(!o),type:"text",children:o?e.jsx(g,{}):e.jsx(q,{})}),children:e.jsxs(n,{layout:"vertical",...r,children:[e.jsxs(H,{gutter:24,children:[e.jsx(j,{span:6,children:e.jsx(n.Item,{label:s("filter.fields.query"),name:"q",children:e.jsx(I,{placeholder:s("filter.placeholders.query"),prefix:e.jsx(V,{})})})}),e.jsx(j,{span:6,children:e.jsx(n.Item,{label:s("requisitions.fields.status"),name:"status",children:e.jsx(y,{allowClear:!0,options:U,placeholder:s("requisitions.placeholders.status")})})}),e.jsx(j,{span:6,children:e.jsx(n.Item,{label:s("requisitions.fields.store"),name:"store_id",children:e.jsx(y,{...m,allowClear:!0,onSearch:void 0,filterOption:!0,optionFilterProp:"label"})})}),e.jsx(j,{span:6,children:e.jsx(n.Item,{label:s("filter.fields.created_at"),name:"createdAt",children:e.jsx(J,{})})})]}),e.jsx(n.Item,{children:e.jsx(S,{htmlType:"submit",type:"primary",children:s("filter.buttons.search")})})]})});return o?l():u()};export{$ as RequisitionList,$ as default};
