import{aB as te,r as d,aa as ne,aC as se,aD as re,aE as ae,aF as le,a1 as oe,aG as ie,aH as ce,aI as de,aJ as S,aK as ue,aL as xe,aM as fe,aN as pe,aO as D,aP as he,aQ as je,az as w,a3 as P,_ as U,a as me,b as be,c as ge,P as Ce,d as c,j as e,e as ye,G as Se,f as H,D as ve,B as _,m as Q,n as h,i as g,N as K,H as Ie,h as Oe,Y as Le,aR as _e,F as p,I as Y,k as G,l as W,o as we,S as M,aA as Pe,aS as Ee,C as ze,p as Te}from"./index-7ade8dfe.js";import{C as Me}from"./container-557faff1.js";import{r as Fe,s as Be,m as Ne}from"./printerfn-12fd91a5.js";import{S as L}from"./index-ef404e1a.js";var Re=globalThis&&globalThis.__rest||function(t,s){var a={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&s.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)s.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(a[r[i]]=t[r[i]]);return a};const ke=t=>{const{prefixCls:s,className:a,closeIcon:r,closable:i,type:o,title:E,children:v}=t,m=Re(t,["prefixCls","className","closeIcon","closable","type","title","children"]),{getPrefixCls:C}=d.useContext(ne),z=C(),j=s||C("modal"),[,T]=se(j),I=`${j}-confirm`;let y={};return o?y={closable:i??!1,title:"",footer:"",children:d.createElement(re,Object.assign({},t,{prefixCls:j,confirmPrefixCls:I,rootPrefixCls:z,content:v}))}:y={closable:i??!0,title:E,footer:t.footer===void 0?d.createElement(ae,Object.assign({},t)):t.footer,children:v},d.createElement(le,Object.assign({prefixCls:j,className:oe(T,`${j}-pure-panel`,o&&I,o&&`${I}-${o}`,a)},m,{closeIcon:ie(j,r),closable:i},y))},Ae=te(ke);function J(t){return S(je(t))}const x=ce;x.useModal=de;x.info=function(s){return S(ue(s))};x.success=function(s){return S(xe(s))};x.error=function(s){return S(fe(s))};x.warning=J;x.warn=J;x.confirm=function(s){return S(pe(s))};x.destroyAll=function(){for(;D.length;){const s=D.pop();s&&s()}};x.config=he;x._InternalPanelDoNotUseOrYouWillBeFired=Ae;const $e=x;var qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M632 888H392c-4.4 0-8 3.6-8 8v32c0 17.7 14.3 32 32 32h192c17.7 0 32-14.3 32-32v-32c0-4.4-3.6-8-8-8zM512 64c-181.1 0-328 146.9-328 328 0 121.4 66 227.4 164 284.1V792c0 17.7 14.3 32 32 32h264c17.7 0 32-14.3 32-32V676.1c98-56.7 164-162.7 164-284.1 0-181.1-146.9-328-328-328zm127.9 549.8L604 634.6V752H420V634.6l-35.9-20.8C305.4 568.3 256 484.5 256 392c0-141.4 114.6-256 256-256s256 114.6 256 256c0 92.5-49.4 176.3-128.1 221.8z"}}]},name:"bulb",theme:"outlined"};const Ve=qe;var De={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M709.6 210l.4-.2h.2L512 96 313.9 209.8h-.2l.7.3L151.5 304v416L512 928l360.5-208V304l-162.9-94zM482.7 843.6L339.6 761V621.4L210 547.8V372.9l272.7 157.3v313.4zM238.2 321.5l134.7-77.8 138.9 79.7 139.1-79.9 135.2 78-273.9 158-274-158zM814 548.3l-128.8 73.1v139.1l-143.9 83V530.4L814 373.1v175.2z"}}]},name:"code-sandbox",theme:"outlined"};const He=De;var Ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M64 556.9l264.2 173.5L512.5 577 246.8 412.7zm896-290.3zm0 0L696.8 95 512.5 248.5l265.2 164.2L512.5 577l184.3 153.4L960 558.8 777.7 412.7zM513 609.8L328.2 763.3l-79.4-51.5v57.8L513 928l263.7-158.4v-57.8l-78.9 51.5zM328.2 95L64 265.1l182.8 147.6 265.7-164.2zM64 556.9z"}}]},name:"dropbox",theme:"outlined"};const Ye=Ke;var Ge={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};const We=Ge;var Ue=function(s,a){return d.createElement(w,P({},s,{ref:a,icon:Ve}))};const Qe=d.forwardRef(Ue);var Je=function(s,a){return d.createElement(w,P({},s,{ref:a,icon:He}))};const Xe=d.forwardRef(Je);var Ze=function(s,a){return d.createElement(w,P({},s,{ref:a,icon:Ye}))};const et=d.forwardRef(Ze);var tt=function(s,a){return d.createElement(w,P({},s,{ref:a,icon:We}))};const nt=d.forwardRef(tt),{RangePicker:st}=Te,ct=()=>{var F,B,N,R,k,A,$,q;const t=U(),[s,a]=d.useState(!1),{tableProps:r,searchFormProps:i,tableQueryResult:o}=me({syncWithLocation:!0,filters:{permanent:[{field:"statistics",operator:"eq",value:!0}]},onSearch:n=>{const l=[],{q:f,name:u,code:b,status:V,container_type:Z,stock_level:ee,createdAt:O}=n;return l.push({field:"container_type",operator:"eq",value:Z},{field:"stock_level",operator:"eq",value:ee},{field:"query",operator:"eq",value:f},{field:"name",operator:"eq",value:u},{field:"code",operator:"eq",value:b},{field:"createdAt",operator:"gte",value:O?O[0].toISOString():void 0},{field:"createdAt",operator:"lte",value:O?O[1].toISOString():void 0}),l}}),{triggerExport:E,isLoading:v}=be({mapData:n=>{var l,f;return{id:n.id,container_type:n.container_type,name:n.name,code:n.code,address:n.address,stock_level:n.stock_level,approved:n.approved?"YES":"NO",product:(l=n==null?void 0:n.product)==null?void 0:l.name,store:(f=n==null?void 0:n.store)==null?void 0:f.name}}}),[m,C]=ge.useState([]),{mutate:z,isLoading:j}=Ce(),T=()=>{z({resource:"containers",ids:m.map(String)},{onSuccess:()=>{C([])}})},y={selectedRowKeys:m,onChange:n=>{C(n)},selections:[c.SELECTION_ALL,c.SELECTION_INVERT,c.SELECTION_NONE]},X=async()=>{if(!(r!=null&&r.dataSource))return;a(!0);let n=0,l=0;const f=r.dataSource.filter(u=>m.includes(u==null?void 0:u.id)).map(u=>Fe(Me,{CONTAINER_CODE:u.code}))||[];for(let u of f){const b=new Blob([u],{type:"text/plain"});try{await Be(b),n++}catch(V){console.error("Error sending print job:",V),l++}}a(!1),Ne.info(`Printing completed. Success: ${n}, Failed: ${l}`)};return e.jsxs(ye,{headerButtons:({defaultButtons:n})=>e.jsxs(e.Fragment,{children:[n,e.jsx(Se,{onClick:E,loading:v})]}),headerProps:{subTitle:e.jsxs(H,{children:[e.jsx(ve,{selectedKeys:m,isLoading:j,onDelete:T}),e.jsx(_,{disabled:m.length<1,type:"primary",onClick:X,children:t("buttons.print-barcode")})]})},children:[e.jsxs(Q,{gutter:18,style:{marginBottom:"10px"},children:[e.jsx(h,{span:6,children:e.jsx(g,{bordered:!1,children:e.jsx(L,{title:"EMPTY",value:((B=(F=o==null?void 0:o.data)==null?void 0:F.statistics)==null?void 0:B.empty)||0,valueStyle:{color:"#3f8600"},prefix:e.jsx(et,{})})})}),e.jsx(h,{span:6,children:e.jsx(g,{bordered:!1,children:e.jsx(L,{title:"PARTIAL",value:((R=(N=o==null?void 0:o.data)==null?void 0:N.statistics)==null?void 0:R.partial)||0,valueStyle:{color:"#e8b30d"},prefix:e.jsx(nt,{})})})}),e.jsx(h,{span:6,children:e.jsx(g,{bordered:!1,children:e.jsx(L,{title:"FULL",value:((A=(k=o==null?void 0:o.data)==null?void 0:k.statistics)==null?void 0:A.full)||0,valueStyle:{color:"#1393cf"},prefix:e.jsx(Xe,{})})})}),e.jsx(h,{span:6,children:e.jsx(g,{bordered:!1,children:e.jsx(L,{title:"WAITING FOR APPROVAL",value:((q=($=o==null?void 0:o.data)==null?void 0:$.statistics)==null?void 0:q.waiting_for_approval)||0,valueStyle:{color:"#cf7413"},prefix:e.jsx(Qe,{})})})})]}),e.jsx(rt,{formProps:i}),e.jsxs(c,{...r,rowSelection:y,rowKey:"id",pagination:{...r.pagination,showSizeChanger:!0},children:[e.jsx(c.Column,{title:t("table.s_no"),render:(n,l,f)=>{let u=1,b=10;return typeof r.pagination=="object"&&(u=r.pagination.current??1,b=r.pagination.pageSize??10),(u-1)*b+f+1}},"index"),e.jsx(c.Column,{dataIndex:"container_type",title:t("containers.fields.container_type"),sorter:!0}),e.jsx(c.Column,{dataIndex:"name",title:t("containers.fields.name"),sorter:!0}),e.jsx(c.Column,{dataIndex:"code",title:t("containers.fields.code"),sorter:!0}),e.jsx(c.Column,{dataIndex:"stock_level",title:t("containers.fields.stock_level"),sorter:!0}),e.jsx(c.Column,{dataIndex:"approved",title:t("containers.fields.approved"),sorter:!0,render:(n,l,f)=>(l==null?void 0:l.stock_level)==="EMPTY"?"":l==null?void 0:l.approved}),e.jsx(c.Column,{dataIndex:["store","name"],title:t("containers.fields.store")}),e.jsx(c.Column,{dataIndex:"product",title:t("containers.fields.product"),render:n=>n?e.jsx(K,{value:n==null?void 0:n.name},n==null?void 0:n.id):null}),e.jsx(c.Column,{dataIndex:"storelocation",title:t("containers.fields.address"),render:n=>n?e.jsx(K,{value:(n==null?void 0:n.code)??"Not Placed"},n==null?void 0:n.id):null}),e.jsx(c.Column,{title:t("table.actions"),dataIndex:"actions",render:(n,l)=>e.jsxs(H,{children:[e.jsx(Ie,{hideText:!0,size:"small",recordItemId:l.id}),e.jsx(Oe,{hideText:!0,size:"small",recordItemId:l.id}),e.jsx(Le,{hideText:!0,size:"small",recordItemId:l.id})]})})]}),e.jsx($e,{open:s,footer:null,closable:!1,centered:!0,children:e.jsx("div",{style:{textAlign:"center",padding:"40px"},children:e.jsx(_e,{tip:t("models.loader.body"),size:"large",children:"Â "})})})]})},rt=({formProps:t})=>{const s=U(),[a,r]=d.useState(!0),i=()=>e.jsx(g,{title:e.jsx(p,{layout:"inline",...t,onFinish:t==null?void 0:t.onFinish,children:e.jsx(p.Item,{name:"q",style:{width:"100%"},children:e.jsx(Y.Search,{placeholder:s("filter.placeholders.query"),enterButton:s("filter.buttons.search")})})}),extra:e.jsx(_,{type:"text",onClick:()=>r(!a),children:a?e.jsx(G,{}):e.jsx(W,{})}),bodyStyle:{padding:"0px"}}),o=()=>e.jsx(g,{title:s("filter.title"),extra:e.jsx(_,{onClick:()=>r(!a),type:"text",children:a?e.jsx(G,{}):e.jsx(W,{})}),children:e.jsxs(p,{layout:"vertical",...t,children:[e.jsxs(Q,{gutter:24,children:[e.jsx(h,{span:6,children:e.jsx(p.Item,{label:s("filter.fields.query"),name:"q",children:e.jsx(Y,{placeholder:s("filter.placeholders.query"),prefix:e.jsx(we,{})})})}),e.jsx(h,{span:6,children:e.jsx(p.Item,{label:s("containers.fields.container_type"),name:"container_type",children:e.jsx(M,{allowClear:!0,options:Pe,placeholder:s("containers.placeholders.container_type")})})}),e.jsx(h,{span:6,children:e.jsx(p.Item,{label:s("containers.fields.stock_level"),name:"stock_level",children:e.jsx(M,{allowClear:!0,options:Ee,placeholder:s("containers.placeholders.stock_level")})})}),e.jsx(h,{span:6,children:e.jsx(p.Item,{label:s("containers.fields.status"),name:"status",children:e.jsx(M,{allowClear:!0,options:ze,placeholder:s("containers.placeholders.status")})})}),e.jsx(h,{span:6,children:e.jsx(p.Item,{label:s("filter.fields.created_at"),name:"createdAt",children:e.jsx(st,{})})})]}),e.jsx(p.Item,{children:e.jsx(_,{htmlType:"submit",type:"primary",children:s("filter.buttons.search")})})]})});return a?i():o()};export{ct as ContainerList,ct as default};
