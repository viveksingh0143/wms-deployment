import{_ as g,r as f,T as D,a as O,j as t,q as S,F as i,I as j,S as v,C as F,bb as m,d}from"./index-7ade8dfe.js";const q=()=>{var c;const n=g(),[u,E]=f.useState([]),[h,$]=f.useState([]),{formProps:T,saveButtonProps:C,form:_,onFinish:I,queryResult:p}=D(),{tableProps:b}=O({resource:"permissions",hasPagination:!1,sorters:{permanent:[{field:"group_name",order:"desc"}]}}),P=l=>{l.abilities=l.abilities.map(e=>{if(e!==null&&e!==""&&(typeof e=="string"||e instanceof String)){const[s,a]=e.split("::");return{module:s,name:a}}}),I(l)};let o=(c=p==null?void 0:p.data)==null?void 0:c.data;o&&(o.abilities=o.abilities.map(l=>typeof l=="object"&&l!==null?`${l==null?void 0:l.module}::${l==null?void 0:l.name}`:l));const R={selectedRowKeys:u,onChange:(l,e)=>{const s=new Set(_.getFieldValue("abilities"));l.length<u.length?u.filter(x=>!l.includes(x)).forEach(x=>{const r=h.find(A=>A.id===x);r&&(s.delete(`${r.module_name}::READ`),s.delete(`${r.module_name}::CREATE`),s.delete(`${r.module_name}::UPDATE`),s.delete(`${r.module_name}::DELETE`),s.delete(`${r.module_name}::IMPORT`),s.delete(`${r.module_name}::EXPORT`))}):e.forEach(a=>{s.add(`${a.module_name}::READ`),s.add(`${a.module_name}::CREATE`),s.add(`${a.module_name}::UPDATE`),s.add(`${a.module_name}::DELETE`),s.add(`${a.module_name}::IMPORT`),s.add(`${a.module_name}::EXPORT`)}),_.setFieldValue("abilities",Array.from(s)),E(l),$(e)}};return t.jsx(S,{saveButtonProps:C,children:t.jsxs(i,{...T,initialValues:o,onFinish:P,layout:"vertical",children:[t.jsx(i.Item,{label:n("roles.fields.id"),name:["id"],rules:[{required:!0}],children:t.jsx(j,{readOnly:!0,disabled:!0})}),t.jsx(i.Item,{label:n("roles.fields.name"),name:["name"],rules:[{required:!0}],children:t.jsx(j,{})}),t.jsx(i.Item,{label:n("roles.fields.status"),name:["status"],rules:[{required:!0}],children:t.jsx(v,{allowClear:!0,options:F,placeholder:"Status"})}),t.jsx(i.Item,{name:["abilities"],children:t.jsx(m.Group,{style:{width:"100%"},children:t.jsxs(d,{...b,rowSelection:R,rowKey:"id",style:{width:"100%"},children:[t.jsx(d.Column,{title:n("table.s_no"),render:(l,e,s)=>s+1},"index"),t.jsx(d.Column,{dataIndex:"group_name",title:n("permissions.fields.group_name")}),t.jsx(d.Column,{dataIndex:"module_name",title:n("permissions.fields.module_name")}),t.jsx(d.Column,{dataIndex:"read_perm",title:n("permissions.fields.read_perm"),render:(l,e)=>e.read_perm?t.jsx(m,{value:`${e.module_name}::READ`}):null}),t.jsx(d.Column,{dataIndex:"create_perm",title:n("permissions.fields.create_perm"),render:(l,e)=>e.create_perm?t.jsx(m,{value:`${e.module_name}::CREATE`}):null}),t.jsx(d.Column,{dataIndex:"update_perm",title:n("permissions.fields.update_perm"),render:(l,e)=>e.update_perm?t.jsx(m,{value:`${e.module_name}::UPDATE`}):null}),t.jsx(d.Column,{dataIndex:"delete_perm",title:n("permissions.fields.delete_perm"),render:(l,e)=>e.delete_perm?t.jsx(m,{value:`${e.module_name}::DELETE`}):null}),t.jsx(d.Column,{dataIndex:"import_perm",title:n("permissions.fields.import_perm"),render:(l,e)=>e.import_perm?t.jsx(m,{value:`${e.module_name}::IMPORT`}):null}),t.jsx(d.Column,{dataIndex:"export_perm",title:n("permissions.fields.export_perm"),render:(l,e)=>e.export_perm?t.jsx(m,{value:`${e.module_name}::EXPORT`}):null})]})})})]})})};export{q as RoleEdit,q as default};
