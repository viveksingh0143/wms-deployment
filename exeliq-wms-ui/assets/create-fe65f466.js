import{_ as w,T as F,R as y,j as e,V as R,F as t,aT as _,J as b,m as T,n as u,p as v,S as j,I as f,C as O,d as p,B as S}from"./index-7ade8dfe.js";import{M as L}from"./MinusCircleOutlined-f6a845b7.js";const P=()=>{const s=w(),{formProps:r,saveButtonProps:g}=F(),{selectProps:C}=y({resource:"customers",optionLabel:"name",optionValue:"id"}),{selectProps:q,queryResult:x}=y({resource:"products",optionLabel:"name",optionValue:"id"}),I=(c,m)=>{var n,a,o,d;const{items:i}=(n=r==null?void 0:r.form)==null?void 0:n.getFieldsValue(["items"]);i[m].product_id=c,i[m].product=(o=(a=x==null?void 0:x.data)==null?void 0:a.data)==null?void 0:o.find(l=>l.id===c),(d=r==null?void 0:r.form)==null||d.setFieldsValue({items:i})};return e.jsx(R,{saveButtonProps:g,children:e.jsx(t,{...r,initialValues:{issued_date:null,po_category:_[0].value,status:1},layout:"vertical",children:e.jsxs(b,{defaultActiveKey:"1",children:[e.jsx(b.TabPane,{tab:s("joborders.tabs.basic"),forceRender:!0,children:e.jsxs(T,{gutter:24,children:[e.jsx(u,{span:12,children:e.jsx(t.Item,{label:s("joborders.fields.issued_date"),name:["issued_date"],rules:[{required:!0}],children:e.jsx(v,{style:{width:"100%"}})})}),e.jsx(u,{span:12,children:e.jsx(t.Item,{label:s("joborders.fields.customer"),name:["customer","id"],rules:[{required:!0,message:s("rules.requiredOption")}],children:e.jsx(j,{placeholder:s("joborders.fields.customer"),...C})})}),e.jsx(u,{span:12,children:e.jsx(t.Item,{label:s("joborders.fields.order_no"),name:["order_no"],rules:[{required:!0}],children:e.jsx(f,{})})}),e.jsx(u,{span:12,children:e.jsx(t.Item,{label:s("joborders.fields.po_category"),name:["po_category"],rules:[{required:!0}],children:e.jsx(j,{allowClear:!0,options:_,placeholder:s("joborders.fields.po_category")})})}),e.jsx(u,{span:12,children:e.jsx(t.Item,{label:s("joborders.fields.status"),name:["status"],rules:[{required:!0}],children:e.jsx(j,{allowClear:!0,options:O,placeholder:s("joborders.fields.status")})})})]})},"1"),e.jsx(b.TabPane,{tab:s("joborders.tabs.items"),forceRender:!0,children:e.jsx(t.List,{name:["items"],children:(c,{add:m,remove:i})=>e.jsxs(e.Fragment,{children:[e.jsxs(p,{dataSource:c,pagination:!1,rowKey:"key",children:[e.jsx(p.Column,{title:s("joborders.items.fields.product"),dataIndex:"product_id",render:(n,a,o)=>e.jsx(t.Item,{name:[a.name,"product_id"],rules:[{required:!0,message:s("rules.requiredOption")}],children:e.jsx(j,{placeholder:s("joborders.items.placeholders.product"),...q,onChange:d=>I(d,a.name)})})},"product_id"),e.jsx(p.Column,{title:s("joborders.items.fields.quantity"),dataIndex:"quantity",render:(n,a,o)=>{var h;const d=(h=r==null?void 0:r.form)==null?void 0:h.getFieldValue(["items",a.name,"product"]);let l=d==null?void 0:d.unit_type;return l&&l!=="PIECE"&&(l=d.unit_weight_type),e.jsx(t.Item,{name:[a.name,"quantity"],rules:[{required:!0}],getValueFromEvent:V=>Number(V.target.value),children:e.jsx(f,{type:"number",placeholder:s("joborders.items.placeholders.quantity"),addonAfter:l})})}},"quantity"),e.jsx(p.Column,{title:s("table.actions"),dataIndex:"action",render:(n,a,o)=>e.jsx(t.Item,{children:e.jsx(L,{onClick:()=>i(o)})})})]}),e.jsx(S,{type:"dashed",onClick:()=>m(),style:{width:"100%"},children:s("joborders.items.buttons.add")})]})})},"2")]})})})};export{P as JobOrderCreate,P as default};
