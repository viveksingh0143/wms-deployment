import{M as _,_ as T,a as N,b as R,c as k,P as z,d as n,j as e,e as D,G as A,f as y,D as B,N as K,B as f,H as P,h as V,Y as G,r as H,R as I,i as b,F as i,I as v,k as E,l as L,m as M,n as C,o as Y,S as U,C as W,p as $}from"./index-7ade8dfe.js";import{c as J,g as Q,C as X}from"./converters-a3674b07.js";import{E as Z}from"./EnvironmentOutlined-6794e44e.js";const{RangePicker:ee}=$,le=()=>{const d=_(),a=T(),{tableProps:r,searchFormProps:h}=N({syncWithLocation:!0,onSearch:t=>{const s=[],{q:c,name:o,code:m,status:O,category_id:F,createdAt:S}=t;return s.push({field:"query",operator:"eq",value:c},{field:"name",operator:"eq",value:o},{field:"code",operator:"eq",value:m},{field:"status",operator:"eq",value:O},{field:"category_id",operator:"eq",value:F},{field:"createdAt",operator:"gte",value:S?S[0].toISOString():void 0},{field:"createdAt",operator:"lte",value:S?S[1].toISOString():void 0}),s}}),{triggerExport:u,isLoading:p}=R({mapData:t=>{var s,c;return{id:t.id,name:t.name,code:t.code,address:t.address,status:t.status,category:((s=t==null?void 0:t.category)==null?void 0:s.name)||"",approvers:((c=t==null?void 0:t.approvers)==null?void 0:c.map(o=>o==null?void 0:o.name).join(", "))||""}}}),[x,j]=k.useState([]),{mutate:g,isLoading:l}=z(),q=()=>{g({resource:"stores",ids:x.map(String)},{onSuccess:()=>{j([])}})},w={selectedRowKeys:x,onChange:t=>{j(t)},selections:[n.SELECTION_ALL,n.SELECTION_INVERT,n.SELECTION_NONE]};return e.jsxs(D,{headerButtons:({defaultButtons:t})=>e.jsxs(e.Fragment,{children:[t,e.jsx(A,{onClick:u,loading:p})]}),headerProps:{subTitle:e.jsx(y,{children:e.jsx(B,{selectedKeys:x,isLoading:l,onDelete:q})})},children:[e.jsx(te,{formProps:h}),e.jsxs(n,{...r,rowSelection:w,rowKey:"id",pagination:{...r.pagination,showSizeChanger:!0},children:[e.jsx(n.Column,{title:a("table.s_no"),render:(t,s,c)=>{let o=1,m=10;return typeof r.pagination=="object"&&(o=r.pagination.current??1,m=r.pagination.pageSize??10),(o-1)*m+c+1}},"index"),e.jsx(n.Column,{dataIndex:"name",title:a("stores.fields.name"),sorter:!0}),e.jsx(n.Column,{dataIndex:"code",title:a("stores.fields.code"),sorter:!0}),e.jsx(n.Column,{dataIndex:"status",title:a("stores.fields.status"),sorter:!0}),e.jsx(n.Column,{dataIndex:["category","name"],title:a("stores.fields.category"),sorter:!0}),e.jsx(n.Column,{dataIndex:"approvers",title:a("stores.fields.approvers"),render:t=>e.jsx(e.Fragment,{children:t==null?void 0:t.map(s=>e.jsx(K,{value:s==null?void 0:s.name},s==null?void 0:s.name))})}),e.jsx(n.Column,{title:a("table.actions"),dataIndex:"actions",render:(t,s)=>e.jsxs(y,{children:[e.jsx(f,{icon:e.jsx(Z,{}),onClick:()=>d(`show/${s==null?void 0:s.id}/locations`),size:"small"}),e.jsx(P,{hideText:!0,size:"small",recordItemId:s.id}),e.jsx(V,{hideText:!0,size:"small",recordItemId:s.id}),e.jsx(G,{hideText:!0,size:"small",recordItemId:s.id})]})})]})]})},te=({formProps:d})=>{var g;const a=T(),[r,h]=H.useState(!0),{queryResult:u}=I({resource:"categories"}),p=J(((g=u==null?void 0:u.data)==null?void 0:g.data)||[],null,null);I({resource:"categories",optionLabel:"name",optionValue:"id"});const x=()=>e.jsx(b,{title:e.jsx(i,{layout:"inline",...d,onFinish:d==null?void 0:d.onFinish,children:e.jsx(i.Item,{name:"q",style:{width:"100%"},children:e.jsx(v.Search,{placeholder:a("filter.placeholders.query"),enterButton:a("filter.buttons.search")})})}),extra:e.jsx(f,{type:"text",onClick:()=>h(!r),children:r?e.jsx(E,{}):e.jsx(L,{})}),bodyStyle:{padding:"0px"}}),j=()=>e.jsx(b,{title:a("filter.title"),extra:e.jsx(f,{onClick:()=>h(!r),type:"text",children:r?e.jsx(E,{}):e.jsx(L,{})}),children:e.jsxs(i,{layout:"vertical",...d,children:[e.jsxs(M,{gutter:24,children:[e.jsx(C,{span:6,children:e.jsx(i.Item,{label:a("filter.fields.query"),name:"q",children:e.jsx(v,{placeholder:a("filter.placeholders.query"),prefix:e.jsx(Y,{})})})}),e.jsx(C,{span:6,children:e.jsx(i.Item,{label:a("stores.fields.status"),name:"status",children:e.jsx(U,{allowClear:!0,options:W,placeholder:a("stores.placeholders.status")})})}),e.jsx(C,{span:6,children:e.jsx(i.Item,{label:a("stores.fields.category"),name:"category_id",getValueProps:l=>l?{value:Q(l,p)}:{value:null},getValueFromEvent:l=>l?l[l.length-1]:null,children:e.jsx(X,{options:p,fieldNames:{label:"name",value:"id",children:"children"},expandTrigger:"hover",changeOnSelect:!0,allowClear:!0})})}),e.jsx(C,{span:6,children:e.jsx(i.Item,{label:a("filter.fields.created_at"),name:"createdAt",children:e.jsx(ee,{})})})]}),e.jsx(i.Item,{children:e.jsx(f,{htmlType:"submit",type:"primary",children:a("filter.buttons.search")})})]})});return r?x():j()};export{le as StoreList,le as default};
